(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Login"],{"0866":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("header",{staticClass:"header v-center"},[e.$app.logoPath?e._m(0):e._e(),r("h1",{staticClass:"header-title v-to-zero"},[e._v(e._s(e.title))])]),r("main",[r("AForm",{staticClass:"login-form",attrs:{form:e.loginForm},on:{submit:function(t){return t.preventDefault(),e.login(t)}}},[r("AFormItem",[r("AInput",{directives:[{name:"decorator",rawName:"v-decorator",value:e.getRules("userName"),expression:"getRules('userName')"}],attrs:{placeholder:"用户名:",size:"large"},on:{pressEnter:function(t){return t.preventDefault(),e.setPasswordFocus(!0)},focus:function(t){return e.setPasswordFocus(!1)}}},[r("AIcon",{staticClass:"login-form-icon",attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),r("AFormItem",[r("AInput",{directives:[{name:"decorator",rawName:"v-decorator",value:e.getRules("password"),expression:"getRules('password')"},{name:"focus",rawName:"v-focus",value:e.passwordFocus,expression:"passwordFocus"}],attrs:{type:"password",size:"large",placeholder:"密码:"}},[r("AIcon",{staticClass:"login-form-icon",attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),r("AFormItem",[r("ACheckbox",{directives:[{name:"decorator",rawName:"v-decorator",value:e.getRules("remember"),expression:"getRules('remember')"}]},[e._v("自动登录")]),r("a",{staticClass:"login-form-forgot",attrs:{href:""}},[e._v("忘记密码")]),r("AButton",{attrs:{loading:e.loading,size:"large",type:"primary","html-type":"submit",block:""}},[e._v("\n                    登录\n                ")])],1)],1)],1)])},a=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("img",{staticClass:"header-logo",attrs:{src:e.publicPath+e.$app.logoPath,alt:"logo",height:"46"}})}],o=r("2f62");function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},s=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),s.forEach(function(t){l(e,t,r[t])})}return e}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var n={name:"Login",directives:{focus(e,t){let r=t.value;if(r){const t=Array.prototype.find,r=t.call(e.childNodes,e=>"input"===e.localName);r&&r.focus()}}},data(){return{title:this.$app.title.main,publicPath:"",loading:!1,passwordFocus:!1}},beforeCreate(){this.loginForm=this.$form.createForm(this)},created(){this.login=this.$util.throttle(this.login,360,!0),this.setRules()},methods:i({},Object(o["b"])("user",["handleLogin"]),{login(){this.loginForm.validateFieldsAndScroll((e,t)=>{e||(this.loading=!0,this.clearDB(),this.handleLogin(t).then(()=>{this.$router.push({name:this.$app.mainName}),this.loading=!1}).catch(e=>{this.loading=!1,this.$message.error(e.msg)}))})},setRules(){this.rulesForm={userName:{initialValue:"xycc",validateFirst:!0,normalize:e=>e?e.toString().trim():null,rules:[{required:!0,whitespace:!0,message:"请输入你的用户名!"},{min:4,message:"不少于4个字符"},{max:30,message:"不超过30个字符"},{validator:this.validateToPassword}]},password:{initialValue:"xycczz",validateFirst:!0,normalize:e=>e?e.toString().trim():null,rules:[{required:!0,whitespace:!0,message:"请输入你的密码!"},{min:6,message:"不少于5个字符"},{max:45,message:"不超过45个字符"},{validator:this.compareToUserName}]},remember:{valuePropName:"checked",initialValue:!0}}},getRules(e){return[e,this.rulesForm[e]]},setPasswordFocus(e){this.passwordFocus=e},compareToUserName(e,t,r){if(t===this.loginForm.getFieldValue("userName"))return r(new Error("密码不能和用户名重复"));r()},validateToPassword(e,t,r){t&&this.loginForm.getFieldValue("password")&&this.loginForm.validateFields(["password"],{force:!0}),r()},clearDB(e){this.isClearDB||this.$db.get("userInfo",{}).userName===e||(this.$db.clear(),this.isClearDB=!0)}})},c=n,u=(r("8070"),r("2877")),m=Object(u["a"])(c,s,a,!1,null,"99811b28",null);t["default"]=m.exports},"55de":function(e,t,r){},8070:function(e,t,r){"use strict";var s=r("55de"),a=r.n(s);a.a}}]);